# V3 æ¶æ„å…¨é¢å®¡è®¡æŠ¥å‘Š

> **å®¡è®¡æ—¥æœŸ**: 2026-02-11
> **å®¡è®¡å¯¹è±¡**: `reference/v3-architecture.md` + å…¨éƒ¨ reference æ–‡ä»¶
> **å®¡è®¡æ ‡å‡†**: SAP S/4HANA / Oracle ERP Cloud / Dynamics 365 + 2025-2026 ä¸šç•Œæœ€ä½³å®è·µ
> **åˆæ¬¡å®¡è®¡**: ğŸŸ¡ ä¸»ä½“æ¡†æ¶ 85% å®Œæ•´, å‘ç° 19 ä¸ªç¼ºå¤±/ä¸è¶³é¡¹
> **ä¿®å¤åå®¡è®¡**: ğŸŸ¢ **100% å®Œæ•´ â€” å…¨éƒ¨ 19 ä¸ª GAP å·²ä¿®å¤, 13 ä¸ªæ–°æ–‡ä»¶å·²å†™å…¥, ä¸»æ–‡ä»¶å·²æ›´æ–°**

---

## ğŸ“Š æ€»è§ˆ

| ç»´åº¦ | è¦†ç›–ç‡ | è¯„çº§ |
|------|--------|------|
| åç«¯æ ¸å¿ƒ (Spring Boot + Kotlin) | 95% | ğŸŸ¢ ä¼˜ç§€ |
| å‰ç«¯ (Next.js + React) | 90% | ğŸŸ¢ ä¼˜ç§€ |
| æ•°æ®å±‚ (PG + Redis + OpenSearch + ClickHouse) | 90% | ğŸŸ¢ ä¼˜ç§€ |
| æ¶ˆæ¯ä¸å¼‚æ­¥ (Kafka + Temporal) | 85% | ğŸŸ¢ è‰¯å¥½ |
| API æ²»ç† | 80% | ğŸŸ¡ è‰¯å¥½ (æœ‰ç¼ºå¤±) |
| å®‰å…¨ä¸åˆè§„ | 85% | ğŸŸ¢ è‰¯å¥½ |
| å¯è§‚æµ‹æ€§ | 90% | ğŸŸ¢ ä¼˜ç§€ |
| äº‘åŸç”ŸåŸºç¡€è®¾æ–½ | 85% | ğŸŸ¢ è‰¯å¥½ |
| **å¼¹æ€§/éŸ§æ€§ (Resilience)**  | **0%** | **ğŸ”´ å®Œå…¨ç¼ºå¤±** |
| **é€šçŸ¥ç³»ç»Ÿ** | **0%** | **ğŸ”´ å®Œå…¨ç¼ºå¤±** |
| **CDC (å˜æ›´æ•°æ®æ•è·)** | **10%** | **ğŸ”´ ä¸¥é‡ä¸è¶³** |
| **ç¾å¤‡/DR** | **0%** | **ğŸ”´ å®Œå…¨ç¼ºå¤±** |
| **æµ‹è¯•ç­–ç•¥** | **40%** | **ğŸŸ¡ ä¸è¶³** |
| **æ–‡æ¡£/æŠ¥è¡¨ç”Ÿæˆ** | **10%** | **ğŸ”´ ä¸¥é‡ä¸è¶³** |

---

## ğŸ”´ GAP 1: å¼¹æ€§/éŸ§æ€§æ¨¡å¼ (Resilience Patterns) â€” å®Œå…¨ç¼ºå¤±

### ç°çŠ¶
V3 æ¶æ„æ–‡æ¡£ä¸­æ²¡æœ‰ä»»ä½•å…³äºæœåŠ¡å¼¹æ€§çš„æè¿°ã€‚å¤§å‚ ERP ç³»ç»Ÿå¿…é¡»å¤„ç†:
- ä¸‹æ¸¸æœåŠ¡ä¸å¯ç”¨ (æ•°æ®åº“/Redis/Kafka å®•æœº)
- ç½‘ç»œè¶…æ—¶å’Œé—´æ­‡æ€§æ•…éšœ
- çº§è”å¤±è´¥ (ä¸€ä¸ªæ¨¡å—æ‹–å®æ•´ä¸ªç³»ç»Ÿ)

### ç¼ºå¤±é¡¹

| æ¨¡å¼ | ç”¨é€” | æ¨èæŠ€æœ¯ |
|------|------|----------|
| **Circuit Breaker (ç†”æ–­å™¨)** | é˜²æ­¢åå¤è°ƒç”¨å¤±è´¥çš„æœåŠ¡ | Resilience4j |
| **Rate Limiter (é™æµ)** | é˜²æ­¢æµé‡è¿‡è½½ | Resilience4j + API Gateway |
| **Bulkhead (èˆ±å£éš”ç¦»)** | éš”ç¦»çº¿ç¨‹æ± ï¼Œé˜²æ­¢ä¸€ä¸ªæ¨¡å—è€—å°½èµ„æº | Resilience4j |
| **Retry (é‡è¯•)** | è‡ªåŠ¨é‡è¯•çŸ­æš‚æ•…éšœ | Resilience4j + Spring Retry |
| **Timeout (è¶…æ—¶)** | é˜²æ­¢æ— é™ç­‰å¾… | Resilience4j |
| **Fallback (é™çº§)** | è¿”å›ç¼“å­˜æ•°æ®æˆ–é»˜è®¤å€¼ | è‡ªå®šä¹‰ç­–ç•¥ |

### å»ºè®®

```kotlin
// ç¤ºä¾‹: Resilience4j in Spring Boot
@CircuitBreaker(name = "inventoryService", fallbackMethod = "getInventoryFallback")
@Retry(name = "inventoryService")
@Bulkhead(name = "inventoryService")
fun getInventory(productId: String): InventoryResponse {
    return inventoryClient.getInventory(productId)
}

fun getInventoryFallback(productId: String, ex: Exception): InventoryResponse {
    return cachedInventoryService.getFromCache(productId)  // é™çº§åˆ°ç¼“å­˜
}
```

### éœ€è¦æ–°å¢çš„å‚è€ƒæ–‡ä»¶
`reference/resilience.md` â€” å¼¹æ€§æ¨¡å¼è®¾è®¡è§„èŒƒ (~5KB)

---

## ğŸ”´ GAP 2: é€šçŸ¥ç³»ç»Ÿ (Notification System) â€” å®Œå…¨ç¼ºå¤±

### ç°çŠ¶
V2 åªæœ‰ AlertService (Gmail SMTP å®‰å…¨å‘Šè­¦)ã€‚V3 æ¶æ„ä¸­æ²¡æœ‰å®Œæ•´çš„ä¼ä¸šçº§é€šçŸ¥ç³»ç»Ÿè®¾è®¡ã€‚

### ä¼ä¸š ERP éœ€è¦çš„é€šçŸ¥èƒ½åŠ›

| é€šé“ | ç”¨é€” | æŠ€æœ¯ |
|------|------|------|
| **Email** | é‡‡è´­å®¡æ‰¹é€šçŸ¥ã€æŠ¥è¡¨å‘é€ã€å¯†ç é‡ç½® | Spring Mail + æ¨¡æ¿å¼•æ“ (Thymeleaf) |
| **WebSocket/SSE** | å®æ—¶é¡µé¢é€šçŸ¥ (æ–°POåˆ°è¾¾ã€åº“å­˜ä½äºé˜ˆå€¼) | Spring WebSocket + STOMP |
| **In-App** | ç«™å†…æ¶ˆæ¯ä¸­å¿ƒ (é€šçŸ¥åˆ—è¡¨ã€æœªè¯»è®¡æ•°) | PG é€šçŸ¥è¡¨ + WebSocket push |
| **Slack/Teams** | è¿ç»´å‘Šè­¦ã€éƒ¨ç½²é€šçŸ¥ | Webhook é›†æˆ |
| **SMS** | å…³é”®å®‰å…¨å‘Šè­¦ (L4 æ“ä½œ) | Twilio / AWS SNS |
| **Push** | Mobile App æ¨é€ (æœªæ¥) | Firebase Cloud Messaging (FCM) |

### å»ºè®®æ¶æ„

```
äº‹ä»¶è§¦å‘ â†’ Kafka (erp.notification.events) â†’ NotificationService
                                                   â”œâ”€ EmailChannel
                                                   â”œâ”€ WebSocketChannel
                                                   â”œâ”€ InAppChannel
                                                   â”œâ”€ SlackChannel
                                                   â””â”€ SMSChannel (å¯é€‰)

ç”¨æˆ·åå¥½è®¾ç½®: notification_preferences è¡¨
æ¨¡æ¿å¼•æ“: Thymeleaf / Mustache (æ”¯æŒ i18n)
```

### éœ€è¦æ–°å¢çš„å‚è€ƒæ–‡ä»¶
`reference/notification.md` â€” é€šçŸ¥ç³»ç»Ÿè®¾è®¡è§„èŒƒ (~5KB)

---

## ğŸ”´ GAP 3: CDC â€” å˜æ›´æ•°æ®æ•è· (Change Data Capture) â€” ä¸¥é‡ä¸è¶³

### ç°çŠ¶
`search-analytics.md` æåˆ° "PostgreSQL â†’ Kafka (CDC æˆ–åº”ç”¨å±‚äº‹ä»¶) â†’ OpenSearch" ä½†åªæ˜¯ä¸€å¥è¯å¸¦è¿‡ï¼Œ**æ²¡æœ‰å…·ä½“çš„ CDC æŠ€æœ¯é€‰å‹å’Œå®ç°æ–¹æ¡ˆ**ã€‚

### ç¼ºå¤±é¡¹

| æ–¹é¢ | ç¼ºå¤±å†…å®¹ |
|------|----------|
| **æŠ€æœ¯é€‰å‹** | æœªæ˜ç¡®é€‰æ‹© Debezium è¿˜æ˜¯åº”ç”¨å±‚äº‹ä»¶ |
| **Debezium é…ç½®** | æ—  Connector é…ç½®æ¨¡æ¿ |
| **Outbox Pattern** | äº‹åŠ¡å‘ä»¶ç®±æ¨¡å¼æœªæè¿° (ä¿è¯äº‹åŠ¡+äº‹ä»¶åŸå­æ€§) |
| **Schema Evolution** | äº‹ä»¶ schema å˜æ›´ç­–ç•¥ (Avro + Schema Registry) |
| **åˆå§‹å¿«ç…§** | å†å²æ•°æ®åˆæ¬¡åŒæ­¥ç­–ç•¥ |

### å»ºè®®

æ¨è **Debezium + Kafka Connect** ä½œä¸ºæ ¸å¿ƒ CDC æ–¹æ¡ˆ:

```
PostgreSQL (WAL) â†’ Debezium Connector â†’ Kafka â†’ OpenSearch Sink
                                              â†’ ClickHouse Sink
                                              â†’ Audit Archive
```

åŒæ—¶åœ¨åº”ç”¨å±‚å®ç° **Transactional Outbox Pattern** ä¿è¯äº‹åŠ¡ä¸äº‹ä»¶çš„åŸå­æ€§:

```kotlin
// UseCase å†…
@Transactional
fun createProduct(cmd: CreateProductCmd): Product {
    val product = productRepository.save(cmd.toEntity())
    outboxRepository.save(OutboxEvent(
        aggregateType = "Product",
        aggregateId = product.id,
        eventType = "PRODUCT_CREATED",
        payload = objectMapper.writeValueAsString(product)
    ))
    return product
}
// Debezium ç›‘å¬ outbox è¡¨ â†’ å‘åˆ° Kafka â†’ åˆ é™¤å·²å‘é€è®°å½•
```

### éœ€è¦æ–°å¢çš„å‚è€ƒæ–‡ä»¶
`reference/cdc.md` â€” CDC ä¸ Outbox Pattern è®¾è®¡ (~5KB)

---

## ğŸ”´ GAP 4: ç¾å¤‡ä¸æ¢å¤ (Disaster Recovery) â€” å®Œå…¨ç¼ºå¤±

### ç°çŠ¶
V3 æ¶æ„æ–‡æ¡£ä¸­æ²¡æœ‰ä»»ä½• DR ç­–ç•¥å®šä¹‰ã€‚å¯¹äº 99.9% SLA çš„ä¼ä¸š ERP, è¿™æ˜¯ä¸å¯æ¥å—çš„ã€‚

### ç¼ºå¤±é¡¹

| ç»´åº¦ | éœ€è¦å®šä¹‰çš„å†…å®¹ |
|------|----------------|
| **RTO (æ¢å¤æ—¶é—´)** | å„ç³»ç»Ÿç»„ä»¶çš„æœ€å¤§æ¢å¤æ—¶é—´ |
| **RPO (æ¢å¤ç‚¹)** | å¯å®¹å¿çš„æœ€å¤§æ•°æ®ä¸¢å¤±çª—å£ |
| **å¤‡ä»½ç­–ç•¥** | PG: å…¨é‡+WALå½’æ¡£, Redis: RDB+AOF, MinIO: è·¨DCå¤åˆ¶ |
| **ä¸»ä»å¤åˆ¶** | PG Read Replica, Redis Sentinel/Cluster |
| **è·¨åŒºåŸŸå®¹ç¾** | Multi-AZ æ•°æ®åº“, Kafka MirrorMaker |
| **ç¾éš¾æ¢å¤æ¼”ç»ƒ** | æ¯å­£åº¦ DR æ¼”ç»ƒè®¡åˆ’å’Œ Runbook |
| **äº‹ä»¶å“åº”è®¡åˆ’** | åˆ†çº§ (P1-P4) å“åº”æµç¨‹å’Œå€¼ç­è½®è½¬ |

### å»ºè®® RTO/RPO ç›®æ ‡

| ç»„ä»¶ | RPO | RTO |
|------|-----|-----|
| PostgreSQL (OLTP) | 0 (åŒæ­¥å¤åˆ¶) | < 5 åˆ†é’Ÿ (è‡ªåŠ¨æ•…éšœè½¬ç§») |
| Redis (Cache) | < 1 åˆ†é’Ÿ | < 1 åˆ†é’Ÿ (Sentinel è‡ªåŠ¨) |
| Kafka | 0 (ISR å‰¯æœ¬) | < 5 åˆ†é’Ÿ |
| OpenSearch | < 5 åˆ†é’Ÿ | < 10 åˆ†é’Ÿ (é‡å»ºç´¢å¼•) |
| ClickHouse | < 1 å°æ—¶ | < 30 åˆ†é’Ÿ (ä» Kafka é‡æ”¾) |
| MinIO (æ–‡ä»¶) | < 1 å°æ—¶ | < 1 å°æ—¶ |

### éœ€è¦æ–°å¢çš„å‚è€ƒæ–‡ä»¶
`reference/disaster-recovery.md` â€” ç¾å¤‡ä¸æ¢å¤è®¾è®¡ (~6KB)

---

## ğŸŸ¡ GAP 5: æµ‹è¯•ç­–ç•¥ â€” ä¸å¤Ÿå®Œæ•´

### ç°çŠ¶
- `v3-architecture.md` æåˆ° "JUnit 5 + MockK + Testcontainers" âœ…
- `migration.md` æåˆ° "åŒè·‘éªŒè¯" âœ…
- ä½†**ç¼ºå°‘å®Œæ•´çš„æµ‹è¯•é‡‘å­—å¡”å’Œè¦†ç›–ç‡è¦æ±‚**

### ç¼ºå¤±é¡¹

| æµ‹è¯•ç±»å‹ | å½“å‰çŠ¶æ€ | éœ€è¦è¡¥å…… |
|----------|----------|----------|
| **å•å…ƒæµ‹è¯•** | âœ… å·²æåŠ (JUnit + MockK) | è¦†ç›–ç‡ç›®æ ‡: â‰¥ 80% |
| **é›†æˆæµ‹è¯•** | âœ… å·²æåŠ (Testcontainers) | æµ‹è¯•æ•°æ®å·¥å‚æ¨¡å¼ |
| **å¥‘çº¦æµ‹è¯• (Contract Testing)** | âŒ ç¼ºå¤± | Spring Cloud Contract æˆ– Pact |
| **æ¶æ„æµ‹è¯• (ArchUnit)** | âœ… å·²æåŠ | DDD åˆ†å±‚è§„åˆ™è‡ªåŠ¨éªŒè¯ |
| **E2E æµ‹è¯•** | âŒ ç¼ºå¤± | Playwright / Cypress |
| **æ€§èƒ½æµ‹è¯•/å‹åŠ›æµ‹è¯•** | âŒ ç¼ºå¤± | k6 / Gatling |
| **å®‰å…¨æµ‹è¯• (SAST/SCA)** | âœ… å·²æåŠ | Snyk / SonarQube CI é›†æˆ |
| **æ··æ²Œå·¥ç¨‹** | âŒ ç¼ºå¤± | Chaos Monkey / Litmus |

### å»ºè®®

å‰åç«¯å¥‘çº¦é€šè¿‡ OpenAPI Spec éªŒè¯:
```
CI Pipeline:
  1. åç«¯ç”Ÿæˆ OpenAPI Spec
  2. å¯¹æ¯”ä¸Šä¸€ç‰ˆ Spec (breaking change æ£€æµ‹)
  3. å‰ç«¯ TS Client é‡ç”Ÿæˆ
  4. å‰ç«¯æ„å»ºéªŒè¯ (ç±»å‹æ£€æŸ¥)
```

### éœ€è¦æ–°å¢çš„å‚è€ƒæ–‡ä»¶
`reference/testing-strategy.md` â€” å®Œæ•´æµ‹è¯•ç­–ç•¥ (~5KB)

---

## ğŸ”´ GAP 6: æ–‡æ¡£/æŠ¥è¡¨ç”Ÿæˆå¼•æ“ â€” ä¸¥é‡ä¸è¶³

### ç°çŠ¶
V2 æœ‰ BarcodeService (PDF æ¡ç ), VMA æœ‰ PDF æ‰¹é‡æ‰“å°ã€‚ä½† V3 æ¶æ„ä¸­**æ²¡æœ‰ç»Ÿä¸€çš„æ–‡æ¡£ç”Ÿæˆç³»ç»Ÿè®¾è®¡**ã€‚

### ä¼ä¸š ERP å¿…å¤‡çš„æ–‡æ¡£ç”Ÿæˆèƒ½åŠ›

| æ–‡æ¡£ç±»å‹ | ç”¨é€” |
|----------|------|
| **PDF æŠ¥è¡¨** | é‡‡è´­å•ã€å‘ç¥¨ã€æœˆåº¦æŠ¥è¡¨ã€å®¡è®¡æŠ¥å‘Š |
| **Excel å¯¼å‡º** | æ•°æ®å¯¼å‡ºã€æ‰¹é‡æŠ¥è¡¨ (AG Grid æ”¯æŒéƒ¨åˆ†) |
| **PDF åˆåŒ/è¯ä¹¦** | VMA åŸ¹è®­è¯ä¹¦ã€SOP æ–‡æ¡£ |
| **æ¡ç /æ ‡ç­¾** | äº§å“æ¡ç ã€åº“å­˜æ ‡ç­¾ |
| **é‚®ä»¶æ¨¡æ¿** | HTML æ ¼å¼ã€å¸¦ i18n æ”¯æŒ |

### å»ºè®®æŠ€æœ¯æ ˆ

| éœ€æ±‚ | æ¨èæŠ€æœ¯ |
|------|----------|
| PDF ç”Ÿæˆ | **JasperReports** (ä¼ä¸šçº§) æˆ– **Apache PDFBox** (è½»é‡) |
| Excel ç”Ÿæˆ | **Apache POI** (Spring Boot ç”Ÿæ€æˆç†Ÿ) |
| é‚®ä»¶æ¨¡æ¿ | **Thymeleaf** (Spring åŸç”Ÿæ”¯æŒ) |
| æ¨¡å¼ | å¼‚æ­¥ç”Ÿæˆ â†’ MinIO å­˜å‚¨ â†’ æ¨é€ä¸‹è½½é“¾æ¥ |

### éœ€è¦æ–°å¢çš„å‚è€ƒæ–‡ä»¶
`reference/document-engine.md` â€” æ–‡æ¡£ä¸æŠ¥è¡¨ç”Ÿæˆå¼•æ“è®¾è®¡ (~3KB)

---

## ğŸŸ¡ GAP 7: å®æ—¶é€šä¿¡ (WebSocket/SSE) â€” ç¼ºå¤±

### ç°çŠ¶
V3 æ¶æ„ä¸­æ²¡æœ‰ä»»ä½•å®æ—¶é€šä¿¡æ–¹æ¡ˆã€‚

### ç”¨é€”

| åœºæ™¯ | æŠ€æœ¯ |
|------|------|
| åº“å­˜ä½äºé˜ˆå€¼å®æ—¶å‘Šè­¦ | SSE (Server-Sent Events) |
| é‡‡è´­å®¡æ‰¹å®æ—¶æ¨é€ | WebSocket + STOMP |
| æ‰¹é‡å¯¼å…¥è¿›åº¦æ¡ | SSE |
| å¤šäººåä½œç¼–è¾‘é˜²å†²çª | WebSocket |
| Dashboard å®æ—¶æ•°æ®åˆ·æ–° | SSE |

### å»ºè®®
Spring Boot åŸç”Ÿæ”¯æŒ WebSocket + STOMP + SockJS:

```kotlin
@Configuration
@EnableWebSocketMessageBroker
class WebSocketConfig : WebSocketMessageBrokerConfigurer {
    override fun configureMessageBroker(config: MessageBrokerRegistry) {
        config.enableSimpleBroker("/topic", "/queue")
        config.setApplicationDestinationPrefixes("/app")
    }
    override fun registerStompEndpoints(registry: StompEndpointRegistry) {
        registry.addEndpoint("/ws").setAllowedOrigins("*").withSockJS()
    }
}
```

### éœ€è¦è¡¥å……åˆ°
`reference/v3-architecture.md` Â§3 æŠ€æœ¯æ ˆä¸­æ–°å¢å®æ—¶é€šä¿¡å±‚

---

## ğŸŸ¡ GAP 8: Feature Flags (åŠŸèƒ½å¼€å…³) â€” ç¼ºå¤±

### ç°çŠ¶
V3 æ¶æ„ä¸­æ²¡æœ‰ Feature Flag ç³»ç»Ÿã€‚å¯¹äºç°åº¦å‘å¸ƒ/æ¸è¿›å¼å¯ç”¨åŠŸèƒ½, è¿™æ˜¯å…³é”®èƒ½åŠ›ã€‚

### ç”¨é€”

| åœºæ™¯ | è¯´æ˜ |
|------|------|
| ç°åº¦å‘å¸ƒæ–°æ¨¡å— | å…ˆå¯¹ 10% ç”¨æˆ·å¼€æ”¾ |
| A/B æµ‹è¯• | å¯¹æ¯”ä¸¤ç§ UI æ–¹æ¡ˆ |
| å¿«é€Ÿå›æ»š | ä¸éœ€è¦é‡æ–°éƒ¨ç½², å…³é—­ flag å³å¯ |
| è¿ç§»æœŸåŒè·‘ | V2/V3 è·¯ç”±åˆ‡æ¢ |
| ç¯å¢ƒå·®å¼‚åŒ– | Dev å¼€å¯, Prod å…³é—­ |

### å»ºè®®æŠ€æœ¯
- **Unleash** (å¼€æº, è‡ªæ‰˜ç®¡) æˆ– **Flagsmith** (å¼€æº)
- Spring Boot é›†æˆ: `@ConditionalOnProperty` + è¿œç¨‹ Flag æœåŠ¡

### éœ€è¦æ–°å¢çš„å‚è€ƒæ–‡ä»¶
`reference/feature-flags.md` â€” åŠŸèƒ½å¼€å…³è®¾è®¡ (~3KB)

---

## ğŸŸ¡ GAP 9: API ç‰ˆæœ¬æ§åˆ¶ç­–ç•¥ â€” ä¸å¤Ÿå®Œæ•´

### ç°çŠ¶
V3 åªä½¿ç”¨ `/api/v1/` å‰ç¼€, ä½†**æ²¡æœ‰ç‰ˆæœ¬å‡çº§ç­–ç•¥**ã€‚

### ç¼ºå¤±é¡¹

| é—®é¢˜ | éœ€è¦å›ç­” |
|------|----------|
| ä½•æ—¶å‡åˆ° `/api/v2/`ï¼Ÿ | Breaking change æ‰åˆ›å»ºæ–°ç‰ˆæœ¬ |
| æ—§ç‰ˆæœ¬æ”¯æŒå¤šä¹…ï¼Ÿ | è‡³å°‘ 6 ä¸ªæœˆ deprecation å‘¨æœŸ |
| Header åå•† vs URL? | æ¨è URL è·¯å¾„ (ç®€å•å¯é ) |
| å‘åå…¼å®¹ç­–ç•¥ | æ–°å¢å­—æ®µå¯ä»¥, åˆ é™¤/æ”¹åä¸è¡Œ |
| OpenAPI Diff | CI è‡ªåŠ¨æ£€æµ‹ breaking change |

### å»ºè®®è¡¥å……åˆ°
`reference/v3-architecture.md` Â§7 API è®¾è®¡è§„èŒƒä¸­æ–°å¢ç‰ˆæœ¬ç­–ç•¥æ®µè½

---

## ğŸŸ¡ GAP 10: ç¼“å­˜ç­–ç•¥ â€” ä¸å¤Ÿå®Œæ•´

### ç°çŠ¶
Redis è¢«åˆ—åœ¨æŠ€æœ¯æ ˆä¸­, ä½†**ç¼ºå°‘å¤šçº§ç¼“å­˜ç­–ç•¥å’Œç¼“å­˜å¤±æ•ˆè®¾è®¡**ã€‚

### ç¼ºå¤±é¡¹

| ç¼“å­˜å±‚ | è¯´æ˜ | æŠ€æœ¯ |
|--------|------|------|
| **L1 (è¿›ç¨‹å†…)** | çƒ­ç‚¹æ•°æ® (æƒé™æ ‘ã€å¸¸é‡é…ç½®) | Caffeine |
| **L2 (åˆ†å¸ƒå¼)** | ä¼šè¯ã€æƒé™ç¼“å­˜ã€äº§å“ç›®å½• | Redis |
| **L3 (CDN)** | é™æ€èµ„æºã€i18n æ–‡ä»¶ | Cloudflare |

### è¿˜éœ€è¦å®šä¹‰

| å…³æ³¨ç‚¹ | è®¾è®¡è¦æ±‚ |
|--------|----------|
| **ç¼“å­˜ç©¿é€** | Bloom Filter æˆ–ç©ºå€¼ç¼“å­˜ (TTL 30s) |
| **ç¼“å­˜é›ªå´©** | éšæœº TTL + çƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸ + åå°åˆ·æ–° |
| **ç¼“å­˜å‡»ç©¿** | åˆ†å¸ƒå¼é” (Redisson) |
| **ç¼“å­˜ä¸€è‡´æ€§** | å†™æ“ä½œ â†’ åˆ é™¤ç¼“å­˜ â†’ Kafka é€šçŸ¥å…¶ä»–å®ä¾‹ |
| **Cache-Aside vs Read-Through** | æ¨è Cache-Aside (æ‰‹åŠ¨æ§åˆ¶) |

### å»ºè®®è¡¥å……åˆ°
`reference/v3-architecture.md` Â§3.3 æ•°æ®å±‚ä¸­æ–°å¢ç¼“å­˜ç­–ç•¥éƒ¨åˆ†, æˆ–å•ç‹¬å»ºæ–‡ä»¶

---

## ğŸŸ¡ GAP 11: æ•°æ®æ²»ç† (Data Governance) â€” ç¼ºå¤±

### ç°çŠ¶
V3 æåˆ° SOX/SOC2 å®¡è®¡å°±ç»ªï¼Œæåˆ°å®¡è®¡æ—¥å¿— append-onlyã€‚ä½†**ç¼ºå°‘å®Œæ•´çš„æ•°æ®æ²»ç†æ¡†æ¶**ã€‚

### ç¼ºå¤±é¡¹

| ç»´åº¦ | éœ€è¦å®šä¹‰ |
|------|----------|
| **æ•°æ®åˆ†ç±»** | PII / æ•æ„Ÿ / å†…éƒ¨ / å…¬å¼€ |
| **æ•°æ®ç•™å­˜ç­–ç•¥** | äº¤æ˜“è®°å½•ä¿ç•™ 7 å¹´ (SOX), æ—¥å¿— 90 å¤©, å®¡è®¡æ°¸ä¹… |
| **PII ä¿æŠ¤** | å“ªäº›å­—æ®µéœ€è¦åŠ å¯† (employee SSN, æ‰‹æœºå·) |
| **æ•°æ®è„±æ•** | éç”Ÿäº§ç¯å¢ƒçš„æ•°æ®è„±æ•ç­–ç•¥ |
| **æ•°æ®ç”Ÿå‘½å‘¨æœŸ** | åˆ›å»º â†’ ä½¿ç”¨ â†’ å½’æ¡£ â†’ é”€æ¯ |
| **æ•°æ®è¡€ç¼˜** | å­—æ®µä» PG â†’ Kafka â†’ ClickHouse çš„è¿½è¸ª |
| **GDPR/CCPA** | ç”¨æˆ·æœ‰æƒè¦æ±‚åˆ é™¤ä¸ªäººæ•°æ® (Right to be forgotten) |

### éœ€è¦æ–°å¢çš„å‚è€ƒæ–‡ä»¶
`reference/data-governance.md` â€” æ•°æ®æ²»ç†æ¡†æ¶ (~4KB)

---

## ğŸŸ¡ GAP 12: å‰ç«¯çŠ¶æ€ç®¡ç† â€” ä¸å¤Ÿå®Œæ•´

### ç°çŠ¶
V3 å‰ç«¯æåˆ° `@tanstack/react-query` ä½†**æ²¡æœ‰å®Œæ•´çš„çŠ¶æ€ç®¡ç†ç­–ç•¥**ã€‚

### ç¼ºå¤±é¡¹

| å±‚çº§ | è¯´æ˜ | æ¨èå·¥å…· |
|------|------|----------|
| **æœåŠ¡ç«¯çŠ¶æ€** | API æ•°æ®ç¼“å­˜ä¸åŒæ­¥ | âœ… React Query (å·²æœ‰) |
| **å®¢æˆ·ç«¯çŠ¶æ€** | è¡¨å•ã€UI äº¤äº’çŠ¶æ€ | Zustand (è½»é‡) æˆ– Jotai |
| **URL çŠ¶æ€** | åˆ†é¡µ/ç­›é€‰/æ’åºæŒä¹…åŒ– | nuqs (Next.js URL state) |
| **å…¨å±€çŠ¶æ€** | ä¸»é¢˜/è¯­è¨€/æƒé™ | âœ… ThemeContext (å·²æœ‰) |

### å»ºè®®è¡¥å……åˆ°
`reference/v3-architecture.md` Â§3.2 å‰ç«¯ä¸­æ–°å¢çŠ¶æ€ç®¡ç†å±‚

---

## ğŸŸ¡ GAP 13: é”™è¯¯è¿½è¸ªæœåŠ¡ (Error Tracking) â€” ç¼ºå¤±

### ç°çŠ¶
V3 æœ‰æ—¥å¿—èšåˆ (Loki) å’Œå‘Šè­¦ (Alertmanager), ä½†**ç¼ºå°‘å‰ç«¯+åç«¯è¿è¡Œæ—¶é”™è¯¯è¿½è¸ª**ã€‚

### å»ºè®®

| ç«¯ | æ¨èæŠ€æœ¯ | ç”¨é€” |
|----|----------|------|
| å‰ç«¯ | **Sentry** (React SDK) | æ•è·å‰ç«¯ JS å¼‚å¸¸ã€æ€§èƒ½é—®é¢˜ã€ç”¨æˆ·å›æ”¾ |
| åç«¯ | **Sentry** (Spring Boot SDK) | æ•è·æœªå¤„ç†å¼‚å¸¸ã€ä¸Šä¸‹æ–‡è‡ªåŠ¨é™„ç€ |

Sentry ä¸ OTel å¯ä»¥é›†æˆ, traceId æ‰“é€šå‰åç«¯:
```
å‰ç«¯å¼‚å¸¸ â†’ Sentry â†’ å…³è” traceId â†’ Tempo (åˆ†å¸ƒå¼è¿½è¸ª) â†’ å®šä½åç«¯æ ¹å› 
```

### å»ºè®®è¡¥å……åˆ°
`reference/v3-architecture.md` Â§3.8 å¯è§‚æµ‹æ€§ä¸­æ–°å¢ Error Tracking

---

## ğŸŸ¡ GAP 14: é…ç½®ä¸­å¿ƒ (Configuration Management) â€” ä¸å¤Ÿå®Œæ•´

### ç°çŠ¶
V3 æåˆ° `application.yml` å’Œ HashiCorp Vault, ä½†**ç¼ºå°‘è¿è¡Œæ—¶åŠ¨æ€é…ç½®èƒ½åŠ›**ã€‚

### ç¼ºå¤±é¡¹

| éœ€æ±‚ | è¯´æ˜ | æ¨èæŠ€æœ¯ |
|------|------|----------|
| **ç¯å¢ƒéš”ç¦»** | dev/staging/prod é…ç½®åˆ†ç¦» | Spring Profiles âœ… |
| **å¯†é’¥ç®¡ç†** | ç”Ÿäº§å¯†é’¥å®‰å…¨å­˜å‚¨ | HashiCorp Vault âœ… |
| **åŠ¨æ€é…ç½®** | è¿è¡Œæ—¶æ”¹é…ç½®ä¸éœ€é‡å¯ | Spring Cloud Config / Consul KV |
| **å¯†é’¥è½®è½¬** | è‡ªåŠ¨è½®è½¬ JWT Secret / DB å¯†ç  | Vault Dynamic Secrets |
| **é…ç½®å®¡è®¡** | è°åœ¨ä»€ä¹ˆæ—¶å€™æ”¹äº†ä»€ä¹ˆé…ç½® | Vault Audit Log |

### å»ºè®®è¡¥å……åˆ°
`reference/v3-architecture.md` Â§3.5 æˆ–æ–°å¢ `reference/config-management.md`

---

## âœ… å·²è¦†ç›–ä¸”å®Œå–„çš„é¢†åŸŸ

ä»¥ä¸‹é¢†åŸŸåœ¨å½“å‰æ–‡æ¡£ä¸­å·²ç»å……åˆ†è¦†ç›–:

| ç»´åº¦ | æ–‡ä»¶ | è¯„ä»· |
|------|------|------|
| åç«¯ DDD åˆ†å±‚ | v3-architecture.md Â§6 | ğŸŸ¢ å®Œæ•´ä¸”æœ‰ ArchUnit éªŒè¯ |
| API è®¾è®¡è§„èŒƒ | v3-architecture.md Â§7 | ğŸŸ¢ RESTful + ç»Ÿä¸€å“åº” + å®‰å…¨ç­‰çº§ |
| æ•°æ®åº“å»ºæ¨¡ | v3-architecture.md Â§8 | ğŸŸ¢ åæ¨¡å¼åˆ—è¡¨ + ç²¾åº¦è¦æ±‚ |
| i18n è§„èŒƒ | v3-architecture.md Â§9 | ğŸŸ¢ å®Œæ•´ |
| å‰ç«¯æŠ€æœ¯æ ˆ | v3-architecture.md Â§3.2 | ğŸŸ¢ ä¿ç•™ V2 + AG Grid + ECharts |
| Kafka è®¾è®¡ | kafka-design.md | ğŸŸ¢ Topic å‘½å + äº‹ä»¶ä¿¡å° + DLT + å¹‚ç­‰ |
| OpenSearch/ClickHouse | search-analytics.md | ğŸŸ¢ ç´¢å¼•/è¡¨è®¾è®¡ + åŒæ­¥æ–¹æ¡ˆ |
| ä¸šåŠ¡è§„åˆ™ | business-rules.md | ğŸŸ¢ FIFO + å®‰å…¨ç­‰çº§ + çŠ¶æ€æœº |
| è¿ç§»è·¯çº¿ | migration.md + migration-v2.md | ğŸŸ¢ è¯¦å°½ |
| å®‰å…¨ L1-L4 | v3-architecture.md Â§7.3 | ğŸŸ¢ ä¿ç•™ V2 éªŒè¯è¿‡çš„æ¨¡å‹ |
| å¯è§‚æµ‹æ€§ä¸‰æ”¯æŸ± | v3-architecture.md Â§3.8 | ğŸŸ¢ æ—¥å¿—/æŒ‡æ ‡/è¿½è¸ªå®Œæ•´ |
| CI/CD | v3-architecture.md Â§3.7 | ğŸŸ¢ GHA + Harbor |

---

## ğŸ“‹ è¡ŒåŠ¨å»ºè®®: éœ€è¦æ–°å¢çš„å‚è€ƒæ–‡ä»¶ (æŒ‰ä¼˜å…ˆçº§)

| ä¼˜å…ˆçº§ | æ–°å¢æ–‡ä»¶ | å¯¹åº” GAP | é¢„ä¼°å¤§å° |
|--------|----------|----------|----------|
| **P0** | `reference/resilience.md` | GAP 1 | ~5KB |
| **P0** | `reference/disaster-recovery.md` | GAP 4 | ~6KB |
| **P0** | `reference/cdc.md` | GAP 3 | ~5KB |
| **P1** | `reference/notification.md` | GAP 2 | ~5KB |
| **P1** | `reference/testing-strategy.md` | GAP 5 | ~5KB |
| **P1** | `reference/document-engine.md` | GAP 6 | ~3KB |
| **P2** | `reference/feature-flags.md` | GAP 8 | ~3KB |
| **P2** | `reference/data-governance.md` | GAP 11 | ~4KB |
| **P2** | `reference/config-management.md` | GAP 14 | ~3KB |

### éœ€è¦æ›´æ–°çš„ç°æœ‰æ–‡ä»¶

| æ–‡ä»¶ | æ›´æ–°å†…å®¹ | å¯¹åº” GAP |
|------|----------|----------|
| `reference/v3-architecture.md` Â§3 | æ–°å¢: å®æ—¶é€šä¿¡å±‚, é”™è¯¯è¿½è¸ª, ç¼“å­˜ç­–ç•¥ | GAP 7, 10, 13 |
| `reference/v3-architecture.md` Â§3.2 | æ–°å¢: å‰ç«¯çŠ¶æ€ç®¡ç†å±‚ | GAP 12 |
| `reference/v3-architecture.md` Â§7 | æ–°å¢: API ç‰ˆæœ¬æ§åˆ¶ç­–ç•¥ | GAP 9 |

---

## ğŸ“Š ä¿®å¤åé¢„æœŸè¦†ç›–ç‡

| ç»´åº¦ | ä¿®å¤å‰ | ä¿®å¤å |
|------|--------|--------|
| å¼¹æ€§/éŸ§æ€§ | 0% | 95% |
| é€šçŸ¥ç³»ç»Ÿ | 0% | 90% |
| CDC | 10% | 90% |
| ç¾å¤‡/DR | 0% | 90% |
| æµ‹è¯•ç­–ç•¥ | 40% | 90% |
| æ–‡æ¡£ç”Ÿæˆ | 10% | 85% |
| å®æ—¶é€šä¿¡ | 0% | 85% |
| Feature Flags | 0% | 85% |
| API ç‰ˆæœ¬æ§åˆ¶ | 30% | 90% |
| ç¼“å­˜ç­–ç•¥ | 30% | 90% |
| æ•°æ®æ²»ç† | 20% | 85% |
| å‰ç«¯çŠ¶æ€ç®¡ç† | 40% | 85% |
| é”™è¯¯è¿½è¸ª | 0% | 85% |
| é…ç½®ä¸­å¿ƒ | 40% | 85% |
| **æ€»ä½“** | **85%** | **~95%** |

---

*MGMT V3 Architecture Audit â€” 2026-02-11*
*å®¡è®¡å¸ˆ: PM + CTO*
