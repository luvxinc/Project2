<!-- Step 2: 入库选择 -->
<div id="receive-step-select" class="wizard-step-content">
    <!-- 操作须知 -->
    <div class="card bg-dark border-secondary border-opacity-25 mb-4">
        <div class="card-header bg-secondary bg-opacity-10 border-0 py-2">
            <i class="fas fa-question-circle me-2 text-secondary"></i>
            <span class="text-secondary fw-bold small" data-i18n="common.operation_desc">操作说明</span>
        </div>
        <div class="card-body py-2">
            <div class="row">
                <div class="col-md-6">
                    <ul class="text-white-50 small mb-0">
                        <li class="mb-1">
                            <strong class="text-info" data-i18n="ui.text_589">发货单筛选</strong>：<span data-i18n="instructions.desc_83">仅显示发货日期 ≤ 入库日期 且 </span><strong class="text-warning" data-i18n="ui.text_590">未入库</strong> 的发货单
                        </li>
                        <li class="mb-1">
                            <strong class="text-danger" data-i18n="ui.text_591">单一发货单</strong>：<span data-i18n="instructions.desc_46">一次入库只能入库</span><strong class="text-warning" data-i18n="ui.text_592">一个</strong>发货单，如需入库多个发货单请分别创建入库单
                        </li>
                        <li class="mb-1">
                            <strong class="text-info" data-i18n="ui.text_593">全选按钮</strong>：<span data-i18n="instructions.desc_84">将当前发货单所有SKU的入库数量设为发货数量</span>
                        </li>
                        <li>
                            <strong class="text-info" data-i18n="ui.text_594">确认按钮</strong>：<span data-i18n="instructions.desc_80">保存当前发货单的入库数据并进入下一步</span>
                        </li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <ul class="text-white-50 small mb-0">
                        <li class="mb-1">
                            <strong class="text-warning" data-i18n="ui.text_595">入库数量为0</strong>：<span data-i18n="instructions.desc_97">未输入数量的货物按</span><strong>0</strong>计入，后续可通过修改入库单调整
                        </li>
                        <li class="mb-1">
                            <strong class="text-danger" data-i18n="ui.text_596">全零限制</strong>：<span data-i18n="instructions.desc_88">若所有货物入库数量均为0，则不可确认（无实际入库）</span>
                        </li>
                        <li data-i18n="ui.text_597">
                            已入库的发货单不会出现在列表中，每个发货单只能入库一次
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 发货单选择卡片 -->
    <div class="card bg-dark border-info border-opacity-25 mb-4">
        <div class="card-header bg-info bg-opacity-10 border-0 d-flex justify-content-between align-items-center">
            <div>
                <i class="fas fa-boxes me-2 text-info"></i>
                <span class="text-info fw-bold" data-i18n="ui.text_598">选择发货单</span>
                <span class="text-danger ms-2">*</span>
            </div>
            <div id="receive-shipment-loading" class="d-none">
                <span class="spinner-border spinner-border-sm text-info me-2" role="status"></span>
                <span class="text-info small" data-i18n="common.loading">加载中...</span>
            </div>
        </div>
        <div class="card-body">
            <p class="text-white-50 mb-3 small">
                <i class="fas fa-info-circle me-2 text-info"></i>
                以下是截至入库日期 <strong id="receive-date-display" class="text-info">-</strong> 已发货的发货单，请选择需要入库的发货单。
            </p>
            
            <!-- 发货单列表 -->
            <div id="receive-shipment-list" class="row g-3">
                <!-- 动态渲染发货单卡片 -->
                <div class="col-12 text-center py-4 text-white-50" id="receive-shipment-empty">
                    <i class="fas fa-inbox fa-2x opacity-50 mb-2 d-block"></i>
                    等待加载发货单数据...
                </div>
            </div>
        </div>
    </div>
    
    <!-- 货物明细卡片（选择发货单后显示） -->
    <div id="receive-items-card" class="card bg-dark border-warning border-opacity-25 mb-4 d-none">
        <div class="card-header bg-warning bg-opacity-10 border-0 d-flex justify-content-between align-items-center">
            <div>
                <i class="fas fa-list-ul me-2 text-warning"></i>
                <span class="text-warning fw-bold" data-i18n="ui.text_600">货物明细 - </span>
                <span class="text-white" id="receive-current-logistic">-</span>
            </div>
            <div>
                <button type="button" class="btn btn-outline-info btn-sm me-2" id="btn-receive-fill-all">
                    <i class="fas fa-check-double me-1"></i><span data-i18n="common.select_all">全选</span>
                </button>
                <button type="button" class="btn btn-warning btn-sm" id="btn-receive-confirm-items">
                    <i class="fas fa-save me-1"></i><span data-i18n="common.confirm">确认</span>
                </button>
            </div>
        </div>
        <div class="card-body">
            <!-- 货物明细表格 -->
            <div class="table-responsive">
                <table class="table table-dark table-hover align-middle mb-0" id="receive-items-table">
                    <thead>
                        <tr class="text-white-50 small">
                            <th style="width: 30%;">SKU</th>
                            <th style="width: 20%;" data-i18n="purchase.order_num">订单号</th>
                            <th style="width: 20%;" class="text-center" data-i18n="table.shipped_qty">发货数量</th>
                            <th style="width: 30%;" class="text-center" data-i18n="table.received_qty">入库数量</th>
                        </tr>
                    </thead>
                    <tbody id="receive-items-tbody">
                        <!-- 动态渲染 -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- 导航按钮 -->
    <div class="wizard-actions">
        <div class="wizard-actions-left">
            <button type="button" 
                    class="btn btn-outline-secondary btn-lg px-4 rounded-pill" 
                    id="btn-receive-back-2"
                    data-bs-toggle="tooltip" 
                    data-i18n-title="common.back_prev" title="返回上一步">
                <i class="fas fa-arrow-left me-2"></i><span data-i18n="common.back">返回</span>
            </button>
        </div>
        <div class="wizard-actions-right">
            <button type="button" 
                    class="btn btn-info btn-lg px-5 shadow rounded-pill" 
                    id="btn-receive-next-2"
                    disabled
                    data-bs-toggle="tooltip" 
                    data-i18n-title="tooltip.t5367" title="确认选择并继续">
                <i class="fas fa-arrow-right me-2"></i><span data-i18n="common.next">下一步</span>
            </button>
        </div>
    </div>
</div>

<style>
/* 发货单卡片样式 */
.shipment-card {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 1rem;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
}

.shipment-card:hover {
    border-color: rgba(13, 202, 240, 0.5);
    background: rgba(13, 202, 240, 0.1);
}

.shipment-card.active {
    border-color: var(--bs-info);
    background: rgba(13, 202, 240, 0.15);
    box-shadow: 0 0 10px rgba(13, 202, 240, 0.3);
}

.shipment-card .shipment-info {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
}

.shipment-card .shipment-info-item {
    flex: 1 1 45%;
    min-width: 120px;
}

.shipment-card .shipment-info-label {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.5);
}

.shipment-card .shipment-info-value {
    font-size: 0.9rem;
    color: #fff;
    font-weight: 500;
}

/* 入库状态标签 */
.shipment-status-tag {
    position: absolute;
    top: 0.5rem;
    right: 0.5rem;
    font-size: 0.7rem;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
}

.shipment-status-tag.status-pending {
    background: rgba(108, 117, 125, 0.3);
    color: #adb5bd;
}

.shipment-status-tag.status-partial {
    background: rgba(255, 193, 7, 0.3);
    color: #ffc107;
}

.shipment-status-tag.status-complete {
    background: rgba(25, 135, 84, 0.3);
    color: #198754;
}

/* 入库数量输入框 */
.receive-qty-input {
    background: rgba(0, 0, 0, 0.5) !important;
    border-color: rgba(255, 255, 255, 0.2) !important;
    color: #fff !important;
    text-align: center;
    max-width: 120px;
    margin: 0 auto;
    display: block;
}

.receive-qty-input:focus {
    border-color: var(--bs-info) !important;
    box-shadow: 0 0 0 0.2rem rgba(13, 202, 240, 0.25) !important;
}

.receive-qty-input.is-invalid {
    border-color: var(--bs-danger) !important;
}
</style>