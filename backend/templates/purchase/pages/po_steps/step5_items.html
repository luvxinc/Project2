<!-- Step 5: 录入商品信息 -->
<div id="po-step-items" class="wizard-step-content" style="display: none;">
    <!-- 当前模式提示 -->
    <div class="alert alert-info mb-4" id="items-mode-hint">
        <div class="d-flex align-items-center">
            <i class="fas fa-info-circle me-3 text-info"></i>
            <div>
                <span id="items-mode-text"><span data-i18n="desc.d166">当前录入模式</span>：<strong class="text-info"
                        id="current-mode-display">-</strong></span>
            </div>
        </div>
    </div>

    <!-- 上传Excel区域 (Excel模式时显示，手动模式时隐藏) -->
    <div id="upload-section" class="mb-4" style="display: none;">
        <div class="card bg-dark border-primary border-opacity-25">
            <div
                class="card-header bg-primary bg-opacity-10 border-0 d-flex justify-content-between align-items-center">
                <span>
                    <i class="fas fa-file-excel me-2 text-primary"></i>
                    <span class="text-primary fw-bold" data-i18n="ui.text_948">已上传的Excel数据</span>
                </span>
                <span class="badge bg-success" id="excel-item-count-badge" data-i18n="js.items_count_zero">0 条商品</span>
            </div>
            <div class="card-body">
                <p class="text-white-50 small mb-3">
                    <i class="fas fa-check-circle me-1 text-success"></i>
                    Excel文件已在上一步验证通过，商品数据如下。您可以在此处进行修改。
                </p>
                <!-- Excel数据预览/编辑表格 -->
                <div id="excel-items-preview"></div>
            </div>
        </div>
    </div>

    <!-- 注：SKU错误修正现在直接在手动输入表格中进行 -->


    <!-- 手动填写区域 -->
    <div id="manual-section" class="mb-4" style="display: none;">
        <!-- 操作说明卡片 -->
        <div class="card bg-dark bg-opacity-50 border-info border-opacity-25 mb-4">
            <div class="card-header bg-info bg-opacity-10 border-0 d-flex align-items-center">
                <i class="fas fa-info-circle text-info me-2"></i>
                <span class="text-info fw-bold" data-i18n="common.operation_desc">操作说明</span>
            </div>
            <div class="card-body">
                <ul class="text-white-50 small mb-0 ps-3">
                    <li class="mb-2" data-i18n="ui.text_886">每行填写一个商品的SKU、数量和单价。</li>
                    <li class="mb-2" data-i18n="ui.text_887">SKU必须是系统已存在的产品，从下拉列表中选择。</li>
                    <li class="mb-2" data-i18n="ui.text_888">至少填写一行完整数据才能进入下一步。</li>
                    <li data-i18n="ui.text_889">如需新增SKU，请先前往Products完成创建。</li>
                </ul>
            </div>
        </div>

        <!-- 数据输入表格 -->
        <div class="card bg-dark border-secondary border-opacity-25">
            <div
                class="card-header bg-secondary bg-opacity-10 border-0 d-flex justify-content-between align-items-center">
                <span>
                    <i class="fas fa-box me-2 text-secondary"></i>
                    <span class="text-white-50" data-i18n="ui.text_890">商品列表</span>
                    <span class="badge bg-info bg-opacity-25 text-info ms-2" id="currency-badge">RMB</span>
                </span>
            </div>
            <div class="card-body">
                <div class="table-responsive" style="max-height: 400px; overflow-y: auto;">
                    <table class="table table-dark table-hover mb-0" id="items-input-table">
                        <thead>
                            <tr class="text-white-50 small">
                                <th style="width: 35%;">
                                    SKU <span class="text-danger">*</span>
                                    <i class="fas fa-info-circle ms-1" data-bs-toggle="tooltip"
                                        data-i18n-title="tooltip.t1135" title="从系统已有SKU列表中选择"></i>
                                </th>
                                <th style="width: 15%;" class="text-end">
                                    商品数量 <span class="text-danger">*</span>
                                    <i class="fas fa-info-circle ms-1" data-bs-toggle="tooltip"
                                        data-i18n-title="tooltip.t9868" title="输入购买数量，必须大于0"></i>
                                </th>
                                <th style="width: 20%;" class="text-end">
                                    产品单价 <span class="text-danger">*</span>
                                    <i class="fas fa-info-circle ms-1" data-bs-toggle="tooltip"
                                        data-i18n-title="tooltip.t9680" title="输入产品单价"></i>
                                </th>
                                <th style="width: 15%;" class="text-end">
                                    小计
                                    <i class="fas fa-info-circle ms-1" data-bs-toggle="tooltip"
                                        data-i18n-title="tooltip.t908" title="自动计算: 数量 × 单价"></i>
                                </th>
                                <th style="width: 15%;" class="text-center" data-i18n="common.operation">操作</th>
                            </tr>

                        </thead>
                        <tbody id="items-tbody">
                            <!-- 动态生成 -->
                        </tbody>
                        <tfoot>
                            <tr class="text-white border-top border-secondary">
                                <td colspan="3" class="text-end fw-bold" data-i18n="js.total_label">合计:</td>
                                <td id="items-total" class="text-end fw-bold text-success fs-5">0.00</td>
                                <td class="text-center"></td>
                            </tr>
                        </tfoot>

                    </table>
                </div>

                <!-- 添加行按钮组 -->
                <div class="d-flex gap-2 mt-3">
                    <button type="button" class="btn btn-outline-primary btn-sm rounded-pill" id="btn-add-item">
                        <i class="fas fa-plus me-1"></i><span data-i18n="ui.icon_3001">添加一行</span>
                    </button>
                    <button type="button" class="btn btn-outline-secondary btn-sm rounded-pill"
                        id="btn-add-items-batch">
                        <i class="fas fa-layer-group me-1"></i><span data-i18n="ui.icon_3071">批量添加 (5行)</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- 行数统计 -->
        <div class="mt-3 text-center">
            <span class="text-white-50 small" id="row-count-label">
                <i class="fas fa-list me-1"></i><span data-i18n="ui.icon_3273">已填写:</span><strong id="row-count"
                    class="text-info">0</strong> 行
            </span>
        </div>
    </div>

    <!-- 错误提示 -->
    <div id="step5-error" class="text-danger small text-center mb-3"></div>

    <!-- 导航按钮 -->
    <div class="wizard-actions">
        <div class="wizard-actions-left">
            <button type="button" class="btn btn-outline-secondary btn-lg px-4 rounded-pill" id="btn-wizard-back-5"
                data-bs-toggle="tooltip" data-i18n-title="common.back_prev" title="返回上一步">
                <i class="fas fa-arrow-left me-2"></i><span data-i18n="common.back">返回</span>
            </button>
        </div>
        <div class="wizard-actions-right">
            <button type="button" class="btn btn-primary btn-lg px-5 shadow rounded-pill" id="btn-wizard-next-5"
                disabled data-bs-toggle="tooltip" data-i18n-title="js.verify_items" title="验证商品数据">
                <i class="fas fa-arrow-right me-2"></i><span data-i18n="ui.icon_3275">下一步：验证商品</span>
            </button>
        </div>
    </div>
</div>

<style>
    #po-step-items .form-check-label {
        cursor: pointer;
        transition: all 0.2s ease;
    }

    #po-step-items .form-check-label:hover {
        background: rgba(255, 255, 255, 0.03);
    }

    #po-step-items .form-check-input:checked+.form-check-label {
        background: rgba(13, 110, 253, 0.1);
        border-color: rgba(13, 110, 253, 0.5) !important;
    }

    #po-step-items .items-row {
        transition: all 0.2s ease;
    }

    #po-step-items .items-row:hover {
        background: rgba(255, 255, 255, 0.03);
    }

    #po-step-items .items-row.row-valid {
        background: rgba(25, 135, 84, 0.08);
    }

    #po-step-items .items-row.row-invalid {
        background: rgba(220, 53, 69, 0.12);
    }

    #po-step-items .currency-prefix {
        background: rgba(13, 202, 240, 0.15);
        border-right: none;
        color: #0dcaf0;
        font-weight: bold;
    }
</style>