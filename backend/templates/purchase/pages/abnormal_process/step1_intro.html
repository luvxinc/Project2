<!-- 异常处理向导 - 步骤1: 处理说明 -->
<div id="process-step-1" class="wizard-step-content active">

    <!-- 什么是入库异常 -->
    <div class="card bg-dark border-info mb-4">
        <div class="card-header bg-info bg-opacity-10 border-info">
            <i class="fas fa-question-circle me-2 text-info"></i>
            <span class="text-white" data-i18n="ui.text_755">什么是入库异常？</span>
        </div>
        <div class="card-body">
            <p class="text-white-50 mb-3">
                入库异常是指 <strong class="text-warning" data-i18n="ui.text_756">收货数量</strong> 与 <strong class="text-info"
                    data-i18n="table.shipped_qty">发货数量</strong> 不一致的情况，需要进行合规处理。
            </p>
            <div class="alert alert-warning bg-warning bg-opacity-10 border-warning mb-0">
                <i class="fas fa-exclamation-triangle me-2"></i>
                <strong data-i18n="ui.text_758">重要提示：</strong>异常处理基于仓储部门已严格核对后确认的差异数值，非误判或人为清点错误。
            </div>
        </div>
    </div>

    <!-- 当前异常概况 -->
    <div class="card bg-dark border-secondary mb-4">
        <div class="card-header bg-secondary bg-opacity-25 border-secondary">
            <i class="fas fa-chart-bar me-2 text-white-50"></i>
            <span class="text-white" data-i18n="ui.text_759">当前异常概况</span>
        </div>
        <div class="card-body">
            <div class="row g-3">
                <div class="col-md-3">
                    <div class="text-center p-3 rounded bg-dark border border-secondary">
                        <div class="text-white-50 small mb-1" data-i18n="desc.d163">SKU数量</div>
                        <div class="text-white fs-4 fw-bold" id="process-summary-sku-count">-</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="text-center p-3 rounded bg-dark border border-secondary">
                        <div class="text-white-50 small mb-1" data-i18n="ui.text_2279">总差异</div>
                        <div class="text-danger fs-4 fw-bold" id="process-summary-total-diff">-</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="text-center p-3 rounded bg-dark border border-secondary">
                        <div class="text-white-50 small mb-1" data-i18n="ui.text_2280">多收</div>
                        <div class="text-success fs-4 fw-bold" id="process-summary-over">-</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="text-center p-3 rounded bg-dark border border-secondary">
                        <div class="text-white-50 small mb-1" data-i18n="ui.text_2281">少收</div>
                        <div class="text-warning fs-4 fw-bold" id="process-summary-short">-</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 四种处理方式说明 -->
    <div class="card bg-dark border-primary mb-4">
        <div class="card-header bg-primary bg-opacity-10 border-primary">
            <i class="fas fa-list-ol me-2 text-primary"></i>
            <span class="text-white" data-i18n="ui.text_760">异常处理方式</span>
        </div>
        <div class="card-body p-0">
            <div class="list-group list-group-flush bg-transparent">
                <!-- 方式1 -->
                <div class="list-group-item bg-transparent border-secondary px-4 py-3">
                    <div class="d-flex align-items-start">
                        <span class="badge bg-primary rounded-pill me-3 mt-1">1</span>
                        <div>
                            <h6 class="text-white mb-1" data-i18n="ui.text_727">仅修正发货单</h6>
                            <p class="text-white-50 small mb-1">
                                根据实际收货数量修正发货数量使差异为0，<strong class="text-warning"
                                    data-i18n="ui.text_762">不修正订单数量</strong>。
                            </p>
                            <ul class="text-white-50 small mb-2 ps-3">
                                <li><strong class="text-success" data-i18n="ui.text_763">发货数 ≤ 订货数</strong>：<span
                                        data-i18n="instructions.desc_72">剩余部分等待下次发货，</span><span class="text-success"
                                        data-i18n="ui.text_764">无影响</span></li>
                                <li><strong class="text-danger" data-i18n="ui.text_765">发货数 > 订货数</strong>：<span
                                        data-i18n="instructions.desc_24">差异顺延至下次订货，</span><span class="text-danger"
                                        data-i18n="ui.text_766">可能导致计价混乱</span></li>
                            </ul>
                            <span class="badge bg-info bg-opacity-25 text-info"
                                data-i18n="ui.text_767">适用场景：发货数未超订货数，订单仍有余量待发</span>
                        </div>
                    </div>
                </div>
                <!-- 方式2 -->
                <div class="list-group-item bg-transparent border-secondary px-4 py-3">
                    <div class="d-flex align-items-start">
                        <span class="badge bg-success rounded-pill me-3 mt-1">2</span>
                        <div>
                            <h6 class="text-white mb-1" data-i18n="ui.text_730">同步修正发货单与订单</h6>
                            <p class="text-white-50 small mb-1">
                                根据实际收货数量<strong class="text-success"
                                    data-i18n="ui.text_769">同时修改发货数量和订单数量</strong>，使三者（订货量、发货量、入库量）匹配，不产生误差。
                            </p>
                            <span class="badge bg-success bg-opacity-25 text-success"
                                data-i18n="ui.text_770">推荐：数据保持一致性，无后续影响</span>
                        </div>
                    </div>
                </div>
                <!-- 方式3 -->
                <div class="list-group-item bg-transparent border-secondary px-4 py-3">
                    <div class="d-flex align-items-start">
                        <span class="badge bg-warning rounded-pill me-3 mt-1">3</span>
                        <div>
                            <h6 class="text-white mb-1" data-i18n="abnormal.delayed_shipment">新建延迟入库发货单</h6>
                            <p class="text-white-50 small mb-1">
                                将差异数量的货物<strong class="text-warning"
                                    data-i18n="ui.text_772">新建发货单延迟入库</strong>，使当前差异为0。仅适用于<strong class="text-warning"
                                    data-i18n="ui.text_773">入库少于发货</strong>的情况。
                            </p>
                            <span class="badge bg-info bg-opacity-25 text-info"
                                data-i18n="ui.text_774">适用场景：部分货物延迟运达，等待后续入库</span>
                        </div>
                    </div>
                </div>
                <!-- 方式4 -->
                <div class="list-group-item bg-transparent border-secondary px-4 py-3">
                    <div class="d-flex align-items-start">
                        <span class="badge bg-danger rounded-pill me-3 mt-1">4</span>
                        <div>
                            <h6 class="text-white mb-1" data-i18n="ui.text_732">差异算作厂商错误</h6>
                            <p class="text-white-50 small mb-2">
                                <strong class="text-success" data-i18n="ui.text_776">入库多于发货</strong>：<span
                                    data-i18n="instructions.desc_18">多收货物以</span><strong class="text-success"
                                    data-i18n="ui.text_777">成本0</strong>入库；<br>
                                <strong class="text-danger" data-i18n="ui.text_773">入库少于发货</strong>：<span
                                    data-i18n="instructions.desc_51">差异按价格入库后</span><strong class="text-danger"
                                    data-i18n="ui.text_779">立即出库算作耗损</strong>。
                            </p>
                            <span class="badge bg-danger bg-opacity-25 text-danger"
                                data-i18n="ui.text_780">注意：此操作将产生库存变动记录</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 操作按钮 -->
    <div class="d-flex justify-content-end gap-3">
        <button class="btn btn-outline-secondary btn-lg px-4 rounded-pill" onclick="showListView()">
            <i class="fas fa-times me-2"></i><span data-i18n="common.cancel">取消</span>
        </button>
        <button class="btn btn-primary btn-lg px-4 rounded-pill" onclick="goToProcessStep(2)">
            <i class="fas fa-arrow-right me-2"></i><span data-i18n="ui.icon_3234">选取处理方式</span>
        </button>
    </div>
</div>