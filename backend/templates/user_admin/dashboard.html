{% extends "layouts/base.html" %}
{% load static %}

{% block title %}User Access Management - Eaglestar ERP{% endblock %}

{% block content %}
<div class="fade-in">
    <!-- 页面Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="text-white fw-bold mb-1">
                <i class="fa-solid fa-users-gear me-2 text-info"></i><span data-i18n="ui.icon_3001">用户与权限管理中心</span>
            </h4>
            <div class="text-muted small">
                ISO 27001 Access Control &amp; Security Policy Management
            </div>
        </div>
        <div id="header-actions"></div>
    </div>

    <!-- Hub 功能卡片区域 -->
    {% with hub_id="user-admin-hub" hub_items=hub_items module_icon="fas fa-users-gear" module_title="User Access Management" %}
    {% include "components/module_hub.html" %}
    {% endwith %}

</div>

<!-- 通用权限拦截弹窗 -->
<div class="modal fade" id="actionBlockedModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content action-blocked-modal-box">
            <div class="action-blocked-icon">
                <i class="fa-solid fa-ban"></i>
            </div>
            <h4 class="action-blocked-title" id="blocked-action-name" data-i18n="security.restricted_title">操作受限</h4>
            <p class="action-blocked-message" id="blocked-action-reason" data-i18n="ui.text_2">该操作无法<span data-i18n="ui.execute">执行</span></p>
            <button type="button" class="btn btn-danger btn-lg px-5 action-blocked-confirm-btn" data-bs-dismiss="modal">
                <i class="fa-solid fa-check me-2"></i><span data-i18n="modal.btn.confirm">确定</span>
            </button>
        </div>
    </div>
</div>

<script>
    // 操作受限弹窗
    function showActionBlockedModal(actionName, reason) {
        document.getElementById('blocked-action-name').innerText = actionName + (window.i18n?.t('js.action_restricted_suffix') || ' - Action Restricted');
        document.getElementById('blocked-action-reason').innerText = reason;
        var modal = new bootstrap.Modal(document.getElementById('actionBlockedModal'));
        modal.show();
    }

    // 无权限提示（兼容旧调用）
    function showNoPermissionModal(actionName) {
        showActionBlockedModal(actionName, (window.i18n?.t('js.no_permission') || 'You do not have permission'));
    }
</script>

<style>
    /* Action Blocked Modal */
    .action-blocked-modal-box {
        background: linear-gradient(145deg, #1a1a1a, #0d0d0d) !important;
        border: 3px solid #dc3545 !important;
        border-radius: 16px !important;
        padding: 40px 60px;
        text-align: center;
        animation: pulseGlowRed 1.5s ease-in-out infinite, fadeInScale 0.3s ease-out;
    }

    .action-blocked-icon {
        font-size: 4rem;
        color: #dc3545;
        margin-bottom: 20px;
        animation: shake 0.5s ease-in-out;
    }

    .action-blocked-title {
        color: #dc3545;
        font-weight: bold;
        margin-bottom: 15px;
    }

    .action-blocked-message {
        color: #fff;
        font-size: 1.1rem;
        margin-bottom: 30px;
        line-height: 1.6;
    }

    .action-blocked-confirm-btn {
        min-width: 150px;
        font-weight: bold;
    }

    @keyframes pulseGlowRed {

        0%,
        100% {
            box-shadow: 0 0 20px rgba(220, 53, 69, 0.4),
                0 0 40px rgba(220, 53, 69, 0.2),
                inset 0 0 20px rgba(220, 53, 69, 0.1);
        }

        50% {
            box-shadow: 0 0 30px rgba(220, 53, 69, 0.7),
                0 0 60px rgba(220, 53, 69, 0.4),
                0 0 90px rgba(220, 53, 69, 0.2),
                inset 0 0 30px rgba(220, 53, 69, 0.15);
        }
    }

    @keyframes fadeInScale {
        0% {
            opacity: 0;
            transform: scale(0.8);
        }

        100% {
            opacity: 1;
            transform: scale(1);
        }
    }

    @keyframes shake {

        0%,
        100% {
            transform: translateX(0);
        }

        20% {
            transform: translateX(-10px);
        }

        40% {
            transform: translateX(10px);
        }

        60% {
            transform: translateX(-10px);
        }

        80% {
            transform: translateX(10px);
        }
    }
</style>
{% endblock %}