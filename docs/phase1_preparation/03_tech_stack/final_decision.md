# æŠ€æœ¯æ ˆæœ€ç»ˆé€‰åž‹ (Final Decision)

> **æœ¬æ–‡æ¡£è®°å½• MGMT V2 é¡¹ç›®çš„æŠ€æœ¯æ ˆæœ€ç»ˆå†³ç­–åŠç†ç”±ã€‚**

---

## 1. å†³ç­–æ€»è§ˆ

| å±‚çº§ | æœ€ç»ˆé€‰åž‹ | å¤‡é€‰æ–¹æ¡ˆ | å†³ç­–ç†ç”± |
|------|----------|----------|----------|
| **è¯­è¨€** | TypeScript 5.x | Python, Go | å…¨æ ˆç±»åž‹å…±äº«ï¼Œå‰åŽç«¯ä¸€è‡´ |
| **Monorepo** | pnpm + Turborepo | Nx, Lerna | è½»é‡ã€å¿«é€Ÿã€ç¤¾åŒºæ´»è·ƒ |
| **åŽç«¯æ¡†æž¶** | NestJS 10.x | Django Ninja, Fastify | DDD å‹å¥½ï¼Œè£…é¥°å™¨è¯­æ³•æ¸…æ™° |
| **æ•°æ®åº“** | PostgreSQL 16 | MySQL 8 | JSONB æ”¯æŒï¼Œæ›´å¼ºçš„ CTE/GIS |
| **ORM** | Prisma | TypeORM, Drizzle | ç±»åž‹æŽ¨æ–­å¼ºï¼Œè¿ç§»å·¥å…·æˆç†Ÿ |
| **Web æ¡†æž¶** | Next.js 14 (App Router) | Remix, SvelteKit | React ç”Ÿæ€ï¼ŒSSR æˆç†Ÿ |
| **Mobile** | React Native + Expo | Flutter | ä¸Ž React ç”Ÿæ€å¤ç”¨ |
| **UI ç»„ä»¶** | shadcn/ui | Ant Design, Chakra | å¯å®šåˆ¶æ€§å¼ºï¼Œä½“ç§¯å° |
| **çŠ¶æ€ç®¡ç†** | Zustand + TanStack Query | Redux, Jotai | è½»é‡ï¼Œä¸Ž React Query é…åˆå¥½ |
| **è®¤è¯** | Passport.js + JWT | Auth0, NextAuth | çµæ´»å¯æŽ§ï¼Œä¸ä¾èµ–ç¬¬ä¸‰æ–¹ |
| **ç¼“å­˜** | Redis | Memcached | æ”¯æŒå¤šæ•°æ®ç»“æž„ï¼Œæ›´é€šç”¨ |
| **ä»»åŠ¡é˜Ÿåˆ—** | BullMQ | Agenda, bee-queue | åŸºäºŽ Redisï¼ŒåŠŸèƒ½å®Œæ•´ |

---

## 2. è¯¦ç»†å†³ç­–è®°å½•

### 2.1 è¯­è¨€: TypeScript

**å†³ç­–**: é‡‡ç”¨ TypeScript ä½œä¸ºå…¨æ ˆå¼€å‘è¯­è¨€ã€‚

**ç†ç”±**:
1. âœ… **ç±»åž‹å®‰å…¨**: ç¼–è¯‘æ—¶å‘çŽ°é”™è¯¯ï¼Œå‡å°‘çº¿ä¸Šé—®é¢˜
2. âœ… **å…¨æ ˆå…±äº«**: å‰åŽç«¯å…±ç”¨ç±»åž‹å®šä¹‰ï¼Œå‡å°‘ç»´æŠ¤æˆæœ¬
3. âœ… **ç”Ÿæ€æˆç†Ÿ**: npm åŒ…æ•°é‡å’Œè´¨é‡é¢†å…ˆ
4. âœ… **å›¢é˜Ÿèƒ½åŠ›**: å›¢é˜Ÿå·²æœ‰ JavaScript ç»éªŒï¼Œå­¦ä¹ æ›²çº¿ä½Ž

**æ”¾å¼ƒ Python ç†ç”±**:
- âŒ åŠ¨æ€ç±»åž‹ï¼Œç±»åž‹æ³¨è§£ä¸å¼ºåˆ¶
- âŒ å‰åŽç«¯æ— æ³•å…±äº«ç±»åž‹
- âŒ Django æ¨¡æ¿æ¸²æŸ“å·²ä¸é€‚åº”çŽ°ä»£ SPA

---

### 2.2 åŽç«¯æ¡†æž¶: NestJS

**å†³ç­–**: é‡‡ç”¨ NestJS ä½œä¸ºåŽç«¯æ¡†æž¶ã€‚

**ç†ç”±**:
1. âœ… **DDD å‹å¥½**: æ¨¡å—åŒ–è®¾è®¡ï¼Œå¤©ç„¶æ”¯æŒé¢†åŸŸé©±åŠ¨
2. âœ… **ä¾èµ–æ³¨å…¥**: ç±»ä¼¼ Angular/Springï¼Œæ˜“äºŽæµ‹è¯•
3. âœ… **è£…é¥°å™¨è¯­æ³•**: ä»£ç æ¸…æ™°ï¼Œå…ƒæ•°æ®é©±åŠ¨
4. âœ… **OpenAPI é›†æˆ**: `@nestjs/swagger` è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£
5. âœ… **å®ˆå«/æ‹¦æˆªå™¨**: ç»Ÿä¸€å¤„ç†è®¤è¯ã€æ—¥å¿—ã€å¼‚å¸¸

**æ”¾å¼ƒ Django Ninja ç†ç”±**:
- âŒ Python ç”Ÿæ€ï¼Œæ— æ³•ä¸Žå‰ç«¯å…±äº«ç±»åž‹
- âŒ DDD æ”¯æŒä¸å¤ŸåŽŸç”Ÿ
- âŒ éœ€è¦é¢å¤–é…ç½®å¼‚æ­¥æ”¯æŒ

**æ”¾å¼ƒ Fastify ç†ç”±**:
- âŒ ç¼ºä¹ DDD æ¨¡å—åŒ–æ”¯æŒ
- âŒ éœ€è¦æ›´å¤šæ ·æ¿ä»£ç 
- âŒ ç”Ÿæ€ä¸å¦‚ NestJS å®Œæ•´

---

### 2.3 æ•°æ®åº“: PostgreSQL

**å†³ç­–**: ä»Ž MySQL è¿ç§»åˆ° PostgreSQLã€‚

**ç†ç”±**:
1. âœ… **JSONB**: å¯ç´¢å¼•çš„ JSON å­˜å‚¨ï¼Œé€‚åˆæƒé™ç­‰åŠ¨æ€ç»“æž„
2. âœ… **CTE æ”¯æŒ**: é€’å½’æŸ¥è¯¢æ›´å¼ºå¤§
3. âœ… **æ•°ç»„ç±»åž‹**: åŽŸç”Ÿæ”¯æŒ TEXT[]ï¼Œç”¨äºŽæƒé™ actions
4. âœ… **æ‰©å±•æ€§**: PostGISã€pg_trgm ç­‰ä¸°å¯Œæ‰©å±•
5. âœ… **Prisma æ”¯æŒ**: Prisma å¯¹ PostgreSQL æ”¯æŒæ›´å®Œæ•´

**è¿ç§»æˆæœ¬è¯„ä¼°**: ðŸŸ¡ ä¸­ç­‰
- éœ€è¦è°ƒæ•´éƒ¨åˆ† SQL è¯­æ³•
- æ•°æ®ç±»åž‹å¤§éƒ¨åˆ†å…¼å®¹
- éœ€è¦é‡æ–°è®¾è®¡æƒé™å­˜å‚¨

---

### 2.4 ORM: Prisma

**å†³ç­–**: é‡‡ç”¨ Prisma ä½œä¸º ORMã€‚

**ç†ç”±**:
1. âœ… **ç±»åž‹æŽ¨æ–­**: æŸ¥è¯¢ç»“æžœè‡ªåŠ¨æŽ¨æ–­ TypeScript ç±»åž‹
2. âœ… **Schema First**: `.prisma` æ–‡ä»¶æ¸…æ™°å®šä¹‰æ¨¡åž‹
3. âœ… **è¿ç§»å·¥å…·**: `prisma migrate` ç®¡ç†æ•°æ®åº“ç‰ˆæœ¬
4. âœ… **Prisma Studio**: å¯è§†åŒ–æ•°æ®ç®¡ç†

**æ”¾å¼ƒ TypeORM ç†ç”±**:
- âŒ è£…é¥°å™¨è¯­æ³•è¾ƒå†—é•¿
- âŒ ç±»åž‹æŽ¨æ–­ä¸å¦‚ Prisma ç²¾å‡†
- âŒ ç¤¾åŒºå‘å±•æ”¾ç¼“

---

### 2.5 Web æ¡†æž¶: Next.js

**å†³ç­–**: é‡‡ç”¨ Next.js 14 (App Router) ä½œä¸º Web æ¡†æž¶ã€‚

**ç†ç”±**:
1. âœ… **SSR/SSG/CSR**: çµæ´»çš„æ¸²æŸ“ç­–ç•¥
2. âœ… **App Router**: æœ€æ–°çš„è·¯ç”±æž¶æž„ï¼Œæ”¯æŒ Layouts
3. âœ… **React ç”Ÿæ€**: ä¸Ž Mobile å…±äº«ç»„ä»¶é€»è¾‘
4. âœ… **Vercel ä¼˜åŒ–**: éƒ¨ç½²ä½“éªŒæžä½³ (å¦‚éœ€è¦)

**æ”¾å¼ƒ Django Templates + HTMX ç†ç”±**:
- âŒ å¤æ‚äº¤äº’èƒ½åŠ›æœ‰é™
- âŒ æ— æ³•ä¸Ž Mobile å…±äº«ä»£ç 
- âŒ ç¼ºä¹çŽ°ä»£çŠ¶æ€ç®¡ç†

---

### 2.6 UI ç»„ä»¶: shadcn/ui

**å†³ç­–**: é‡‡ç”¨ shadcn/ui ä½œä¸ºåŸºç¡€ UI ç»„ä»¶åº“ã€‚

**ç†ç”±**:
1. âœ… **å¯å®šåˆ¶æ€§**: ç»„ä»¶ä»£ç ç›´æŽ¥å¤åˆ¶ï¼Œå®Œå…¨å¯æŽ§
2. âœ… **ä½“ç§¯å°**: æŒ‰éœ€å¼•å…¥ï¼Œæ— é¢å¤–ä¾èµ–
3. âœ… **Radix åŸºç¡€**: æ— éšœç¢æ”¯æŒè‰¯å¥½
4. âœ… **çŽ°ä»£è®¾è®¡**: ç¬¦åˆå½“å‰è®¾è®¡è¶‹åŠ¿

**ä½¿ç”¨çº¦æŸ**:
- âš ï¸ **å¿…é¡»äºŒæ¬¡å°è£…**: ä¸ç›´æŽ¥åœ¨é¡µé¢ä½¿ç”¨ï¼Œé€šè¿‡ `packages/ui` å°è£…
- âš ï¸ **ç»Ÿä¸€ Token**: ä½¿ç”¨ CSS å˜é‡ç»Ÿä¸€ä¸»é¢˜

**æ”¾å¼ƒ Ant Design ç†ç”±**:
- âŒ åŒ…ä½“ç§¯å¤§
- âŒ æ ·å¼å®šåˆ¶éœ€è¦è¦†ç›–
- âŒ è®¾è®¡é£Žæ ¼åå•†åŠ¡

---

### 2.7 ç§»åŠ¨ç«¯: React Native + Expo

**å†³ç­–**: é‡‡ç”¨ React Native + Expo å¼€å‘ç§»åŠ¨ç«¯ã€‚

**ç†ç”±**:
1. âœ… **ä»£ç å¤ç”¨**: ä¸Ž Web å…±äº«ç±»åž‹ã€å·¥å…·å‡½æ•°ã€API å®¢æˆ·ç«¯
2. âœ… **çƒ­æ›´æ–°**: Expo æ”¯æŒ OTA æ›´æ–°
3. âœ… **å¼€å‘æ•ˆçŽ‡**: åŒä¸€å¥— React æŠ€èƒ½
4. âœ… **åŽŸç”Ÿèƒ½åŠ›**: éœ€è¦æ—¶å¯ eject ä½¿ç”¨åŽŸç”Ÿæ¨¡å—

**æ”¾å¼ƒ Flutter ç†ç”±**:
- âŒ Dart è¯­è¨€ï¼Œä¸Žé¡¹ç›®å…¶ä»–éƒ¨åˆ†ä¸ç»Ÿä¸€
- âŒ æ— æ³•å…±äº« TypeScript ç±»åž‹

---

### 2.8 çŠ¶æ€ç®¡ç†: Zustand + TanStack Query

**å†³ç­–**: 
- **æœåŠ¡å™¨çŠ¶æ€**: TanStack Query (React Query)
- **å®¢æˆ·ç«¯çŠ¶æ€**: Zustand

**ç†ç”±**:
1. âœ… **å…³æ³¨ç‚¹åˆ†ç¦»**: æœåŠ¡å™¨çŠ¶æ€å’Œå®¢æˆ·ç«¯çŠ¶æ€åˆ†å¼€ç®¡ç†
2. âœ… **è½»é‡**: ä¸¤è€…åŠ èµ·æ¥æ¯” Redux æ›´å°
3. âœ… **å¼€å‘ä½“éªŒ**: API ç®€æ´ï¼Œå­¦ä¹ æˆæœ¬ä½Ž
4. âœ… **ç¼“å­˜ç­–ç•¥**: TanStack Query å†…ç½®ç¼“å­˜ã€é‡è¯•ã€åŽ»é‡

**æ”¾å¼ƒ Redux ç†ç”±**:
- âŒ æ ·æ¿ä»£ç å¤š
- âŒ æ¦‚å¿µå¤æ‚ (actions, reducers, middleware)
- âŒ æœåŠ¡å™¨çŠ¶æ€ç®¡ç†ä¸å¤Ÿå¼º

---

## 3. æž¶æž„å†³ç­–

### 3.1 Monorepo ç»“æž„

**å†³ç­–**: é‡‡ç”¨ pnpm workspace + Turborepoã€‚

```
MGMTV2/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ api/          # NestJS åŽç«¯
â”‚   â”œâ”€â”€ web/          # Next.js Web
â”‚   â””â”€â”€ mobile/       # React Native
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ shared/       # å…±äº«ç±»åž‹ã€å·¥å…·
â”‚   â”œâ”€â”€ api-client/   # OpenAPI ç”Ÿæˆçš„å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ ui/           # shadcn äºŒæ¬¡å°è£…
â”‚   â””â”€â”€ config/       # ESLint/Prettier/TSConfig
â””â”€â”€ prisma/           # æ•°æ®åº“ Schema
```

### 3.2 è®¤è¯ç­–ç•¥

**å†³ç­–**: JWT + HttpOnly Cookie

| é¡¹ç›® | å†³ç­– |
|------|------|
| Token å­˜å‚¨ | HttpOnly Cookie (Web) / Secure Storage (Mobile) |
| Access Token æœ‰æ•ˆæœŸ | 15 åˆ†é’Ÿ |
| Refresh Token æœ‰æ•ˆæœŸ | 7 å¤© |
| æƒé™å­˜å‚¨ | JWT Payload + æ•°æ®åº“åŒé‡éªŒè¯ |

### 3.3 API è®¾è®¡

**å†³ç­–**: RESTful + OpenAPI

| é¡¹ç›® | å†³ç­– |
|------|------|
| é£Žæ ¼ | RESTful |
| ç‰ˆæœ¬æŽ§åˆ¶ | URL è·¯å¾„ (`/api/v1/`) |
| æ–‡æ¡£ | OpenAPI 3.0 è‡ªåŠ¨ç”Ÿæˆ |
| å®¢æˆ·ç«¯ | openapi-typescript è‡ªåŠ¨ç”Ÿæˆ |

---

## 4. é£Žé™©ä¸Žç¼“è§£

| é£Žé™© | è¯„ä¼° | ç¼“è§£æŽªæ–½ |
|------|------|----------|
| å›¢é˜Ÿ TypeScript ç»éªŒä¸è¶³ | ðŸŸ¡ ä¸­ | åˆ¶å®šç¼–ç è§„èŒƒï¼Œä»£ç å®¡æŸ¥ |
| PostgreSQL è¿ç§»é—®é¢˜ | ðŸŸ¡ ä¸­ | æå‰æµ‹è¯•æ•°æ®è¿ç§»è„šæœ¬ |
| NestJS å­¦ä¹ æ›²çº¿ | ðŸŸ¢ ä½Ž | ç±»ä¼¼ Angularï¼Œè£…é¥°å™¨è¯­æ³•æ¸…æ™° |
| Prisma æ€§èƒ½é—®é¢˜ | ðŸŸ¢ ä½Ž | å¤æ‚æŸ¥è¯¢å¯ç”¨ $queryRaw |
| Mobile å¼€å‘å»¶è¿Ÿ | ðŸŸ¡ ä¸­ | ä¼˜å…ˆ Webï¼ŒMobile Phase 2+ |

---

## 5. ç‰ˆæœ¬é”å®š

ä¸ºç¡®ä¿å›¢é˜Ÿä¸€è‡´æ€§ï¼Œé”å®šä»¥ä¸‹ç‰ˆæœ¬ï¼š

```json
{
  "typescript": "^5.3.0",
  "node": ">=20.10.0",
  "@nestjs/core": "^10.3.0",
  "next": "^14.1.0",
  "react": "^18.2.0",
  "prisma": "^5.9.0",
  "expo": "^50.0.0"
}
```

---

## 6. å†³ç­–ç­¾ç½²

| è§’è‰² | ç­¾ç½² | æ—¥æœŸ |
|------|------|------|
| é¡¹ç›®è´Ÿè´£äºº | âœ… | 2026-02-04 |
| æŠ€æœ¯è´Ÿè´£äºº | âœ… | 2026-02-04 |
| AI Agent | âœ… | 2026-02-04 |

---

*Version: 1.0.0*
*Created: 2026-02-04*
*Last Updated: 2026-02-04*
